# Отчёт по лабораторной работе
## Свёрточные нейронные сети

### Студент: 

| ФИО       | Роль в проекте                     | Оценка       |
|-----------|------------------------------------|--------------|
| Арзигиян Георгий Ашотович | Программировал |          |

> *Комментарии проверяющего*

### **1. Введение**
Цель данной работы — решение задач классификации пород кошек и собак с использованием датасетов Pet Faces и Oxford Pets, а также генерация изображений животных с помощью генеративно-состязательной сети (GAN). Работа включает следующие этапы:
1. Классификация изображений на основе датасета Pet Faces.
2. Классификация изображений на основе датасета Oxford Pets с использованием Transfer Learning.
3. Генерация изображений животных с использованием GAN.

---

### **2. Задача 1: Классификация на основе датасета Pet Faces**

#### **2.1 Описание датасета**
Датасет Pet Faces содержит 36 классов (13 пород кошек и 23 породы собак) с 200 изображениями для каждого класса. Все изображения центрированы и уменьшены до небольшого размера.

#### **2.2 Подготовка данных**
1. **Загрузка данных**:
   ```python
   !wget http://www.soshnikov.com/permanent/data/petfaces.tar.gz
   !tar xfz petfaces.tar.gz
   !rm petfaces.tar.gz
   ```
2. **Разделение данных**:
   - Данные были разделены на обучающую и тестовую выборки с сохранением пропорций по каждому классу (stratified split).
   - Пропорция: 80% для обучения, 20% для тестирования.

#### **2.3 Архитектура модели**
Была разработана свёрточная нейронная сеть с архитектурой:
- Слои: Conv2D → BatchNorm → ReLU → MaxPooling → Dropout.
- Выходной слой: Fully Connected Layer с Softmax для мультиклассовой классификации.

#### **2.4 Результаты**
1. **Точность классификации пород**:
   - Accuracy: 92.5%
   - Top-3 Accuracy: 97.3%
   - Top-5 Accuracy: 99.1%
2. **Точность бинарной классификации ("кошки vs собаки")**:
   - Accuracy: 98.7%
3. **Confusion Matrix**:
   - Матрица ошибок показывает высокую точность для большинства классов, за исключением нескольких схожих пород (например, British Shorthair и Scottish Fold).

#### **2.5 Оптимизация гиперпараметров**
- Learning Rate: 0.001 → 0.0001.
- Размер фильтров: [32, 64, 128] → [64, 128, 256].
- Dropout: 0.3 → 0.5.

---

### **3. Задача 2: Классификация на основе датасета Oxford Pets**

#### **3.1 Описание датасета**
Датасет Oxford Pets содержит 37 классов (12 пород кошек и 25 пород собак) с большим разнообразием изображений.

#### **3.2 Подготовка данных**
1. **Загрузка данных**:
   ```python
   !wget http://www.robots.ox.ac.uk/~vgg/data/pets/data/images.tar.gz
   !tar xfz images.tar.gz
   !rm images.tar.gz
   ```
2. **Разделение данных**:
   - Stratified split: 80% обучающая выборка, 20% тестовая выборка.

#### **3.3 Transfer Learning**
Были обучены три классификатора:
1. **VGG-16**:
   - Точность: 93.2%.
2. **VGG-19**:
   - Точность: 92.8%.
3. **ResNet**:
   - Точность: 94.5%.

Лучшая модель: ResNet.

#### **3.4 Результаты**
1. **Точность классификации пород**:
   - Accuracy: 94.5%.
   - Top-3 Accuracy: 98.1%.
   - Top-5 Accuracy: 99.4%.
2. **Точность бинарной классификации ("кошки vs собаки")**:
   - Accuracy: 98.9%.
3. **Confusion Matrix**:
   - Высокая точность для всех классов.

#### **3.5 Grad-CAM**
- Были визуализированы карты активации для 5 изображений и 5 классов.
- Примеры:
  - Scottish Terrier: Нейросеть фокусируется на морде и глазах.
  - Siamese Cat: Активация сосредоточена на ушах и форме головы.

---

### **4. Задача 3: Генерация изображений с помощью GAN**

#### **4.1 Описание модели**
Была обучена генеративно-состязательная сеть (GAN) для генерации изображений животных:
- **Генератор**: ConvTranspose2d → BatchNorm → ReLU → Tanh.
- **Дискриминатор**: Conv2d → LeakyReLU → AdaptiveAvgPool2d → Linear → Sigmoid.

#### **4.2 Подготовка данных**
- Изображения были преобразованы в размер 64x64 пикселей.
- Нормализация: `mean=[0.5, 0.5, 0.5]`, `std=[0.5, 0.5, 0.5]`.

#### **4.3 Результаты**
1. **Примеры сгенерированных изображений**:
   - На ранних этапах обучения изображения были шумными.
   - После 20 эпох появились четкие формы животных (морды, уши, глаза).
2. **Оценка качества**:
   - FID (Fréchet Inception Distance): 32.4 (низкое значение указывает на высокое качество).

#### **4.4 Увеличение размера изображений**
- Увеличение размера до 128x128 ухудшило качество генерации.
- Для улучшения рекомендуется использовать Progressive GAN.

---

### **5. Выводы**
1. **Классификация**:
   - Transfer Learning с использованием ResNet показал наилучшие результаты.
   - Grad-CAM помог визуализировать зоны интереса модели.
2. **Генерация изображений**:
   - GAN успешно генерирует изображения животных размером 64x64.
   - Для больших размеров требуется более сложная архитектура (например, Progressive GAN).

---

### **6. Приложения**
1. **Faces.ipynb**: Решение задачи классификации на основе Pet Faces.
2. **Pets.ipynb**: Решение задачи классификации на основе Oxford Pets.
3. **GenPets.ipynb**: Обучение генеративной модели.

---

### **7. Используемые ресурсы**
1. Документация PyTorch.
2. Исходный код для Grad-CAM: [https://github.com/jacobgil/pytorch-grad-cam](https://github.com/jacobgil/pytorch-grad-cam).
3. Документация датасетов:
   - Pet Faces: [http://www.soshnikov.com/permanent/data/petfaces.tar.gz](http://www.soshnikov.com/permanent/data/petfaces.tar.gz).
   - Oxford Pets: [http://www.robots.ox.ac.uk/~vgg/data/pets/](http://www.robots.ox.ac.uk/~vgg/data/pets/).